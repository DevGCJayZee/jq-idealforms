/*--------------------------------------------------------------------------

  jq-idealforms 2.1

  * Author: Cedric Ruiz
  * License: GPL or MIT
  * Demo: http://elclanrs.github.com/jq-idealforms/
  *

--------------------------------------------------------------------------*/(function(e){"use strict";e.idealforms={},e.idealforms.forms={},e.idealforms.filters={},e.idealforms.errors={},e.idealforms.flags={},e.idealforms.ajaxRequests={};var t={getMaxWidth:function(t){var n=0;return t.each(function(){var t=e(this).outerWidth();t>n&&(n=t)}),n},getLessVar:function(t,n){var r=e('<p class="'+t+'"></p>').hide().appendTo("body").css(n);return e("."+t).remove(),/^\d+/.test(r)?parseInt(r,10):r},getKeys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},getObjSize:function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t},isFunction:function(e){return typeof e=="function"},isRegex:function(e){return e instanceof RegExp},isString:function(e){return typeof e=="string"},getByNameOrId:function(t){var n=e('[name="'+t+'"]').length?e('[name="'+t+'"]'):e("#"+t);return n.length?n:e.error('The field "'+t+"\" doesn't exist.")},getFieldsFromArray:function(n){var r=[];for(var i=0,s=n.length;i<s;i++)r.push(t.getByNameOrId(n[i]).get(0));return e(r)},convertToArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"?e:[e]},getIdealType:function(e){var t=e.attr("type")||e[0].tagName.toLowerCase();return/(text|password|email|number|search|url|tel|textarea)/.test(t)&&"text"||/file/.test(t)&&"file"||/select/.test(t)&&"select"||/(radio|checkbox)/.test(t)&&"radiocheck"||/(button|submit|reset)/.test(t)&&"button"||/h\d/.test(t)&&"description"||/hr/.test(t)&&"separator"||/hidden/.test(t)&&"hidden"},makeInput:function(e,t,n,r){function l(e){var t,n,r;return/:/.test(e)?(r=e.split(":"),t=r[0],n=r[1]):t=n=e,{item:t,value:n}}var i,s=[],o,u,a,f;/^(text|password|email|number|search|url|tel|file|hidden)$/.test(t)&&(i='<input type="'+t+'" '+'id="'+e+'" '+'name="'+e+'" '+(r&&'placeholder="'+r+'"')+"/>"),/textarea/.test(t)&&(i='<textarea id="'+e+'" name="'+e+'"></textarea>');if(/select/.test(t)){s=[];for(a=0,f=n.length;a<f;a++)o=l(n[a]).item,u=l(n[a]).value,s.push('<option value="'+u+'">'+o+"</option>");i='<select id="'+e+'" name="'+e+'">'+s.join("")+"</select>"}if(/(radio|checkbox)/.test(t)){s=[];for(a=0,f=n.length;a<f;a++)o=l(n[a]).item,u=l(n[a]).value,s.push('<label><input type="'+t+'" name="'+e+'" value="'+u+'" />'+o+"</label>");i=s.join("")}return i}};e.fn.idealTabs=function(n){var r=e.extend({tabContainer:""},n),i=this,s=e(r.tabContainer),o=e('<ul class="ideal-tabs-wrap"/>'),u=function(){var t=[];return i.each(function(){var n=e(this).attr("name"),r='<li class="ideal-tabs-tab"><span>'+n+"</span>"+'<i class="ideal-tabs-tab-counter ideal-tabs-tab-counter-zero">0</i>'+"</li>";t.push(r)}),e(t.join(""))}(),a={getCurIdx:function(){return u.filter(".ideal-tabs-tab-active").index()},getTabIdxByName:function(t){var n=new RegExp(t,"i"),r=u.filter(function(){return n.test(e(this).text())});return r.index()}},f={switchTab:function(e){var n=t.isString(e)?a.getTabIdxByName(e):e;u.removeClass("ideal-tabs-tab-active"),u.eq(n).addClass("ideal-tabs-tab-active"),i.hide().eq(n).show()},nextTab:function(){var e=a.getCurIdx()+1;e>u.length-1?f.firstTab():f.switchTab(e)},prevTab:function(){f.switchTab(a.getCurIdx()-1)},firstTab:function(){f.switchTab(0)},lastTab:function(){f.switchTab(u.length-1)},updateCounter:function(e,t){var n=a.getTabIdxByName(e),r=u.eq(n).find(".ideal-tabs-tab-counter");r.removeClass("ideal-tabs-tab-counter-zero"),t||r.addClass("ideal-tabs-tab-counter-zero"),r.html(t)}};for(var l in f)i[l]=f[l];return u.first().addClass("ideal-tabs-tab-active").end().click(function(){var t=e(this).text();i.switchTab(t)}),o.append(u).appendTo(s),i.addClass("ideal-tabs-content"),i.each(function(){var t=e(this),n=e(this).attr("name");t.data("ideal-tabs-content-name",n).removeAttr("name")}),i.hide().first().show(),i},e.fn.idealSelect=function(){return this.each(function(){var n=e(this),r=n.find("option"),i=function(){var t=e('<ul class="ideal-select '+n.attr("name")+'"/>'),i=e('<li><span class="ideal-select-title">'+r.filter(":selected").text()+"</span></li>"),s=function(){var t=[];return r.each(function(){var n=e(this);t.push('<li class="ideal-select-item">'+n.text()+"</li>")}),t}();return i.append('<ul class="ideal-select-sub">'+s.join("")+"</ul>"),t.append(i),{select:t,title:i.find(".ideal-select-title"),sub:i.find(".ideal-select-sub"),items:i.find(".ideal-select-item")}}(),s={getSelectedIdx:function(){return i.items.filter(".ideal-select-item-selected").index()},init:function(){n.css({position:"absolute",left:"-9999px"}),i.sub.hide(),i.select.insertAfter(n),i.select.css("min-width",t.getMaxWidth(i.items)),i.items.eq(r.filter(":selected").index()).addClass("ideal-select-item-selected")}(),noWindowScroll:function(e){(e.which===40||e.which===38||e.which===13)&&e.preventDefault()},focusHack:function(){setTimeout(function(){n.trigger("focus")},1)},focus:function(){i.select.addClass("ideal-select-focus"),e(document).on("keydown.noscroll",s.noWindowScroll)},blur:function(){i.select.removeClass("ideal-select-open ideal-select-focus"),e(document).off(".noscroll")},scrollIntoView:function(e){var t=i.items.filter(".ideal-select-item-selected"),n=i.items.outerHeight(),r=i.sub.outerHeight(),s=function(){var i=t.position().top+n;return e==="down"?i<=r:i>0}();s||(n=e==="down"?n:-n,i.sub.scrollTop(i.sub.scrollTop()+n))},scrollToItem:function(){var e=s.getSelectedIdx(),t=i.items.outerHeight(),n=i.items.length,r=t*n,o=t*(n-e);i.sub.scrollTop(r-o)},showMenu:function(){i.sub.fadeIn("fast"),i.select.addClass("ideal-select-open"),s.select(s.getSelectedIdx()),s.scrollToItem()},hideMenu:function(){i.sub.hide(),i.select.removeClass("ideal-select-open")},select:function(e){i.items.removeClass("ideal-select-item-selected"),i.items.eq(e).addClass("ideal-select-item-selected")},change:function(e){var t=i.items.eq(e).text();s.select(e),i.title.text(t),r.eq(e).prop("selected",!0),n.trigger("change")},keydown:function(t){var n=s.getSelectedIdx(),o=i.select.is(".ideal-select-menu"),u=i.select.is(".ideal-select-open"),a={9:function(){o&&(s.blur(),s.hideMenu())},13:function(){o&&(u?s.hideMenu():s.showMenu()),s.change(n)},27:function(){o&&s.hideMenu()},40:function(){n<r.length-1&&(u?s.select(n+1):s.change(n+1)),s.scrollIntoView("down")},38:function(){n>0&&(u?s.select(n-1):s.change(n-1)),s.scrollIntoView("up")},"default":function(){var n=String.fromCharCode(t),r=i.items.filter(function(){var t=new RegExp("^"+n,"i");return t.test(e(this).text())}),o=r.length,a=i.select.data("counter")+1||0,f=i.select.data("key")||t,l=r.eq(a).index();if(!o)return!1;f===t?a<o?i.select.data("counter",a):(i.select.data("counter",0),l=r.eq(0).index()):(i.select.data("counter",0),l=r.eq(0).index()),u?s.select(l):s.change(l),i.select.data("key",t),s.scrollToItem(),s.focusHack()}};a[t]?a[t]():a["default"]()}},o={focus:s.focus,"blur.menu":function(){s.blur(),s.hideMenu()},"blur.list":function(){s.blur()},keydown:function(e){s.keydown(e.which)},"clickItem.menu":function(){s.change(e(this).index()),s.hideMenu()},"clickItem.list":function(){s.change(e(this).index())},"clickTitle.menu":function(){s.focus(),s.showMenu(),n.trigger("focus")},"hideOutside.menu":function(){n.off("blur.menu"),e(document).on("mousedown.ideal",function(t){e(t.target).closest(i.select).length?s.focusHack():(e(document).off("mousedown.ideal"),n.on("blur.menu",o["blur.menu"]))})},"mousedown.list":function(){s.focusHack()}},u=function(){i.select.removeClass("ideal-select-menu ideal-select-list"),n.off(".menu .list"),i.items.off(".menu .list"),i.select.off(".menu .list"),i.title.off(".menu .list")};i.select.on("menu",function(){u(),i.select.addClass("ideal-select-menu"),s.hideMenu(),n.on({"blur.menu":o["blur.menu"],"focus.menu":o.focus,"keydown.menu":o.keydown}),i.select.on("mousedown.menu",o["hideOutside.menu"]),i.items.on("click.menu",o["clickItem.menu"]),i.title.on("click.menu",o["clickTitle.menu"])}),i.select.on("list",function(){u(),i.select.addClass("ideal-select-list"),s.showMenu(),n.on({"blur.list":o["blur.list"],"focus.list":o.focus,"keydown.list":o.keydown}),i.select.on("mousedown.list",o["mousedown.list"]),i.items.on("mousedown.list",o["clickItem.list"])}),n.keydown(function(e){e.which!==9&&e.preventDefault()}),i.select.on("reset",function(){s.change(0)}),i.select.trigger("menu")})},function(){e.fn.idealRadioCheck=function(){return this.each(function(){var t=e(this),n=e("<span/>");n.addClass("ideal-"+(t.is(":checkbox")?"check":"radio")),t.is(":checked")&&n.addClass("checked"),n.insertAfter(t),t.parent("label").addClass("ideal-radiocheck-label").attr("onclick",""),t.css({position:"absolute",left:"-9999px"}),t.on({change:function(){var t=e(this);t.is(":radio")&&t.parent().siblings("label").find(".ideal-radio").removeClass("checked"),n.toggleClass("checked",e(this).is(":checked"))},focus:function(){n.addClass("focus")},blur:function(){n.removeClass("focus")},click:function(){e(this).trigger("focus")}})})}}(),e.fn.idealFile=function(){var t=typeof e("input")[0].multiple!="undefined";return this.each(function(){var n=e(this),r=e('<div class="ideal-file-wrap">'),i=e('<input type="text" class="ideal-file-filename" />'),s=e('<button type="button" class="ideal-file-upload">Open</button>');n.css({position:"absolute",left:"-9999px"}),s.attr("tabIndex",-1).click(function(){n.focus().click()}),n.attr("tabIndex",-1).on({change:function(){var e=[],r,s;if(t){r=n[0].files;for(var o=0,u=r.length;o<u;o++)e.push(r[o].name);s=e.join(", ")}else s=n.val().split("\\").pop();i.val(s),i.attr("title",s)}}),i.on({keyup:function(){n.trigger("change")},focus:function(){n.trigger("change")},blur:function(){n.trigger("blur")},keydown:function(e){e.which===13&&n.trigger("click"),(e.which===8||e.which===46)&&n.val("")}}),r.append(s,i).insertAfter(n)})},e.idealforms.errors={required:"This field is required.",number:"Must be a number.",digits:"Must be only digits.",name:"Must be at least 3 characters long, and must only contain letters.",username:"Must be at between 4 and 32 characters long and start with a letter. You may use letters, numbers, underscores, and one dot (.)",pass:"Must be at least 6 characters long, and contain at least one number, one uppercase and one lowercase letter.",strongpass:"Must be at least 8 characters long and contain at least one uppercase and one lowercase letter and one number or special character.",email:"Must be a valid e-mail address. <em>(e.g. user@gmail.com)</em>",phone:"Must be a valid US phone number. <em>(e.g. 555-123-4567)</em>",zip:"Must be a valid US zip code. <em>(e.g. 33245 or 33245-0003)</em>",url:"Must be a valid URL. <em>(e.g. www.google.com)</em>",minChar:"Must be at least <strong>{0}</strong> characters long.",minOption:"Check at least <strong>{0}</strong> options.",maxChar:"No more than <strong>{0}</strong> characters long.",maxOption:"No more than <strong>{0}</strong> options allowed.",range:"Must be a number between {0} and {1}.",date:"Must be a valid date. <em>(e.g. {0})</em>",dob:"Must be a valid date of birth.",exclude:'"{0}" is not available.',excludeOption:"{0}",equalto:'Must be the same value as <strong>"{0}"</strong>',extension:'File(s) must have a valid extension. <em>(e.g. "{0}")</em>',ajaxSuccess:"<strong>{0}</strong> is not available.",ajaxError:"Server error..."};var n=function(){var t={required:{regex:/.+/,error:e.idealforms.errors.required},number:{regex:function(e,t){return!isNaN(t)},error:e.idealforms.errors.number},digits:{regex:/^\d+$/,error:e.idealforms.errors.digits},name:{regex:/^[A-Za-z]{3,}$/,error:e.idealforms.errors.name},username:{regex:/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i,error:e.idealforms.errors.username},pass:{regex:/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,error:e.idealforms.errors.pass},strongpass:{regex:/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,error:e.idealforms.errors.strongpass},email:{regex:/[^@]+@[^@]/,error:e.idealforms.errors.email},phone:{regex:/^[2-9]\d{2}-\d{3}-\d{4}$/,error:e.idealforms.errors.phone},zip:{regex:/^\d{5}$|^\d{5}-\d{4}$/,error:e.idealforms.errors.zip},url:{regex:/^(?:(ftp|http|https):\/\/)?(?:[\w\-]+\.)+[a-z]{2,6}([\:\/?#].*)?$/i,error:e.idealforms.errors.url},min:{regex:function(t,n){var r=t.input,i=t.userOptions.data.min,s=r.is('[type="checkbox"], [type="radio"]');return s?(this.error=e.idealforms.errors.minOption.replace("{0}",i),r.filter(":checked").length>=i):(this.error=e.idealforms.errors.minChar.replace("{0}",i),n.length>=i)}},max:{regex:function(t,n){var r=t.input,i=t.userOptions.data.max,s=r.is('[type="checkbox"], [type="radio"]');return s?(this.error=e.idealforms.errors.maxOption.replace("{0}",i),r.filter(":checked").length<=i):(this.error=e.idealforms.errors.maxChar.replace("{0}",i),n.length<=i)}},range:{regex:function(t,n){var r=t.userOptions.data.range,i=+n;return this.error=e.idealforms.errors.range.replace("{0}",r[0]).replace("{1}",r[1]),i>=r[0]&&i<=r[1]}},date:{regex:function(t,n){var r=t.userOptions.data&&t.userOptions.data.date?t.userOptions.data.date:"mm/dd/yyyy",i=/[^mdy]/.exec(r)[0],s=r.split(i),o=n.split(i),u=function(e,t){var n,r,i;for(var s=0,o=t.length;s<o;s++)/m/.test(t[s])&&(n=e[s]),/d/.test(t[s])&&(r=e[s]),/y/.test(t[s])&&(i=e[s]);return n>0&&n<13&&i&&i.length===4&&r>0&&r<=(new Date(i,n,0)).getDate()};return this.error=e.idealforms.errors.date.replace("{0}",r),u(o,s)}},dob:{regex:function(n,r){var i=n.userOptions.data&&n.userOptions.data.dob?n.userOptions.data.dob:"mm/dd/yyyy",s={input:n.input,userOptions:{data:{date:i}}},o=t.date.regex(s,r),u=/\d{4}/.exec(r),a=(new Date).getFullYear(),f=a-100;return this.error=e.idealforms.errors.dob,o&&u>=f&&u<=a}},exclude:{regex:function(t,n){var r=t.input,i=t.userOptions.data.exclude,s=r.is('[type="checkbox"], [type="radio"], select');return this.error=s?e.idealforms.errors.excludeOption.replace("{0}",n):this.error=e.idealforms.errors.exclude.replace("{0}",n),e.inArray(n,i)===-1}},equalto:{regex:function(t,n){var r=e(t.userOptions.data.equalto),i=t.input,s=r.attr("name")||r.attr("id"),o=r.parents(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!0}).length;return o?(this.error=e.idealforms.errors.equalto.replace("{0}",s),i.val()===r.val()):!1}},extension:{regex:function(t,n){var r=t.input[0].files||[{name:n}],i=t.userOptions.data.extension,s=new RegExp("\\."+i.join("|")+"$","i"),o=!1;for(var u=0,a=r.length;u<a;u++)o=s.test(r[u].name);return this.error=e.idealforms.errors.extension.replace("{0}",i.join('", "')),o}},ajax:{regex:function(t,n,r){var i=this,s=t.input,o=t.userOptions,u=s.attr("name"),a=s.parents(".ideal-field"),f=!1,l=o.errors&&o.errors.ajax;i.error={},i.error.success=l&&l.success?l.success:e.idealforms.errors.ajaxSuccess.replace("{0}",n),i.error.fail=l&&l.error?l.error:e.idealforms.errors.ajaxError;var c={};c[u]=e.trim(n);var h=e.extend({type:"post",dataType:"json",data:c,success:function(e){r(i.error.success,e),s.data({"ideal-ajax-error":i.error.success,"ideal-ajax-resp":e}),s.trigger("change"),a.removeClass("ajax")},error:function(){r(i.error.fail,!1),s.data("ideal-ajax-error",i.error.fail),a.removeClass("ajax")}},t.userOptions.data.ajax);s.removeData("ideal-ajax-resp"),a.addClass("ajax"),e.idealforms.ajaxRequests[u]=e.ajax(h)}}};return t};e.idealforms.flags={noerror:function(e){e.parent().siblings(".ideal-error").hide()},noicons:function(e){e.siblings(".ideal-icon-valid, .ideal-icon-invalid").hide()},novalidicon:function(e){e.siblings(".ideal-icon-valid").hide()},noinvalidicon:function(e){e.siblings(".ideal-icon-invalid").hide()},noclass:function(e){e.parents(".ideal-field").removeClass("valid invalid")},novalidclass:function(e){e.parents(".ideal-field").removeClass("valid")},noinvalidclass:function(e){e.parents(".ideal-field").removeClass("invalid")}},e.fn.idealforms=function(r){var i=this,s=t.getObjSize(e.idealforms.forms),o=e.idealforms.forms[s]={},u={inputs:{},customFilters:{},customFlags:{},globalFlags:"",onSuccess:function(e){alert("Thank you...")},onFail:function(){alert(i.getInvalid().length+" invalid fields.")},responsiveAt:"auto",disableCustom:""},a=o.options=e.extend({},u,r);e.extend(e.idealforms.filters,n());var f=function(){var e=i.find("section");if(e.length){var t="ideal-tabs-form-"+s;i.prepend('<div class="'+t+' ideal-wrap ideal-tabs ideal-full-width"/>'),e.idealTabs({tabContainer:"."+t})}return e.length?e:!1}(),l=function(){return{inputs:i.find("input, select, textarea, :button"),labels:i.find("div > label:first-child"),text:i.find('input:not([type="checkbox"], [type="radio"], [type="submit"]), textarea'),select:i.find("select"),radiocheck:i.find('input[type="radio"], input[type="checkbox"]'),buttons:i.find(":button"),file:i.find('input[type="file"]'),headings:i.find("h1, h2, h3, h4, h5, h6, p"),separators:i.find("hr"),hidden:i.find("input:hidden")}},c=function(){return i.find('[name="'+t.getKeys(a.inputs).join('"], [name="')+'"]')},h={fieldWidth:t.getLessVar("ideal-field-width","width")},p={getCurrentTabName:function(e){return e.parents(".ideal-tabs-content").data("ideal-tabs-content-name")},getTab:function(t){return f.filter(function(){var n=new RegExp(t,"i");return n.test(e(this).data("ideal-tabs-content-name"))})},updateTabsCounter:function(t){var n;t?(n=i.getInvalidInTab(t).length,f.updateCounter(t,n)):f.each(function(){t=e(this).data("ideal-tabs-content-name"),n=i.getInvalid(name).length,f.updateCounter(t,n)})},doMarkup:function(n){function r(){var t=e('<span class="ideal-error" />'),r=e('<i class="ideal-icon ideal-icon-valid" />'),i=e("<i/>",{"class":"ideal-icon ideal-icon-invalid",click:function(){var t=e(this);t.siblings("label").length?t.siblings("label:first").find("input").focus():t.siblings("input, select, textarea").focus()}});n.parents(".ideal-field").append(r.add(i).hide()).after(t.hide())}var i=t.getIdealType(n),s={_default:e.noop,defaultInput:function(){n.wrapAll('<span class="ideal-field"/>'),r()},button:function(){/button/.test(a.disableCustom)||n.addClass("ideal-button")},file:function(){s.defaultInput(),/file/.test(a.disableCustom)||n.idealFile()},select:function(){s.defaultInput(),/select/.test(a.disableCustom)||n.idealSelect()},text:function(){s.defaultInput()},radiocheck:function(){var e=n.parents(".ideal-field").length,t=n.parent().siblings("label:not(:first-child)").andSelf();/radiocheck/.test(a.disableCustom)||n.idealRadioCheck();if(!!e)return!1;t.wrapAll('<span class="ideal-field ideal-radiocheck"/>'),r()},description:function(){n.closest("div").addClass("ideal-full-width").children().wrapAll('<span class="ideal-heading"/>')},separator:function(){n.closest("div").addClass("ideal-full-width"),n.wrapAll('<div class="ideal-separator"/>')},hidden:function(){n.closest("div").addClass("ideal-hidden")}};n.closest("div").addClass("ideal-wrap"),s[i]?s[i]():s._default()},adjust:function(){var n=l(),r=c();n.inputs.attr("autocomplete","off"),n.labels.removeAttr("style").addClass("ideal-label").width(t.getMaxWidth(n.labels)),f?f.each(function(){e(this).find(".ideal-heading:first").addClass("first-child")}):i.find(".ideal-heading:first").addClass("first-child");var s=i.find("input.datepicker");jQuery.ui&&s.length&&(s.each(function(){var t=a.inputs[this.name],n=t&&t.data&&t.data.date,r=n?n.replace("yyyy","yy"):"mm/dd/yy";e(this).datepicker({dateFormat:r,beforeShow:function(t){e(t).addClass("open")},onChangeMonthYear:function(){var t=e(this).outerWidth();setTimeout(function(){e(this).datepicker("widget").css("width",t)},1)},onClose:function(){e(this).removeClass("open")}})}),s.on("focus keyup",function(){var t=e(this),n=t.outerWidth();t.datepicker("widget").css("width",n)}),s.parent().siblings(".ideal-error").addClass("hidden"))},init:function(){var t=l();i.css("visibility","visible").addClass("ideal-form").attr("novalidate","novalidate"),jQuery.ui&&(e.datepicker._checkOffset=function(e,t,n){return t}),t.inputs.add(t.headings).add(t.separators).each(function(){p.doMarkup(e(this))}),i.find("[data-ideal]").each(function(){a.inputs[this.name]={filters:e(this).data("ideal")}}),p.adjust()},validate:function(n,r){function g(){h.removeClass("valid invalid").removeData("ideal-isvalid"),d.add(v).add(m).hide()}function y(e,t){g(),t?m.show():v.show(),h.addClass(t?"valid":"invalid"),t||(d.html(e).toggle(h.is(".ideal-field-focus")),h.data("ideal-isvalid",!1))}var s=a.inputs[n.attr("name")],o=s.filters&&s.filters.split(" "),u=n.attr("name"),l=n.val(),c=n.is('[type="checkbox"], [type="radio"]'),h=n.parents(".ideal-field"),d=h.siblings(".ideal-error"),v=c?n.parent().siblings(".ideal-icon-invalid"):n.siblings(".ideal-icon-invalid"),m=c?n.parent().siblings(".ideal-icon-valid"):n.siblings(".ideal-icon-valid"),b=n.data("ideal-value")||0;n.data("ideal-value",l);if(r.type==="keyup"&&l===b)return!1;o&&e.each(o,function(o,a){var f=e.idealforms.filters[a],h=s.errors&&s.errors[a],p="",v={input:c?i.find('[name="'+u+'"]'):n,userOptions:s};if(!l&&a!=="required")return g(),!1;if(f)if(a==="ajax"){var m=e.idealforms.ajaxRequests[u];y(p,!1),r.type==="keyup"?(m&&m.abort(),f.regex(v,l,y),d.hide()):y(n.data("ideal-ajax-error"),n.data("ideal-ajax-resp"))}else{var b=t.isRegex(f.regex)&&f.regex.test(l)||t.isFunction(f.regex)&&f.regex(v,l);p=h||f.error,y(p,b);if(!b)return!1}});var w=function(){var t=s.flags&&s.flags.split(" ")||[];return a.globalFlags&&e.each(a.globalFlags.split(),function(e,n){t.push(n)}),t}();w.length&&e.each(w,function(t,i){var s=e.idealforms.flags[i];s&&s(n,r.type)}),f&&p.updateTabsCounter(p.getCurrentTabName(n))},attachEvents:function(){c().on("keyup change focus blur",function(t){var n=e(this),r=n.parents(".ideal-field"),i=n.is("input[type=file]");(t.type==="focus"||i&&t.type==="change")&&r.addClass("ideal-field-focus"),t.type==="blur"&&r.removeClass("ideal-field-focus"),p.validate(n,t)})},responsive:function(){var t=l(),n=h.fieldWidth+t.labels.outerWidth(),r=t.labels.filter(function(){return e(this).html()==="&nbsp;"}),s=i.find(".ideal-select");a.responsiveAt==="auto"?i.toggleClass("stack",i.width()<n):i.toggleClass("stack",e(window).width()<a.responsiveAt);var o=i.is(".stack");r.toggle(!o),s.trigger(o?"list":"menu");var u=i.find("input.hasDatepicker");u.length&&u.datepicker("hide")}};return i.addFields=function(n){n=t.convertToArray(n);var r=[],s=function(n){var s=n.name,o={filters:n.filters||"",data:n.data||{},errors:n.errors||{},flags:n.flags||""},u=n.label||"",f=n.type,l=n.list||[],c=n.placeholder||"",h=e("<div><label>"+u+":</label>"+t.makeInput(s,f,l,c)+"</div>"),d=h.find("input, select, textarea, :button");o.filters&&(a.inputs[s]=o),p.doMarkup(d),n.addAfter?h.insertAfter(e(t.getByNameOrId(n.addAfter)).parents(".ideal-wrap")):n.addBefore?h.insertBefore(e(t.getByNameOrId(n.addBefore)).parents(".ideal-wrap")):n.appendToTab?h.insertAfter(p.getTab(n.appendToTab).find(".ideal-wrap:last-child")):h.insertAfter(i.find(".ideal-wrap").last()),r.push(s)};for(var o=0,u=n.length;o<u;o++)s(n[o]);return i.reload(),i.freshFields(r),p.responsive(),i},i.removeFields=function(e){e=t.convertToArray(e);var n=t.getFieldsFromArray(e);return n.parents(".ideal-wrap").remove(),f&&p.updateTabsCounter(),i.reload(),i},i.getInvalid=function(){return i.find(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!1})},i.getInvalidInTab=function(t){return p.getTab(t).find(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!1})},i.isValid=function(){return!i.getInvalid().length},i.isValidField=function(e){var n=t.getByNameOrId(e);return n.parents(".ideal-field").data("ideal-isvalid")===!0},i.focusFirst=function(){return f?f.filter(":visible").find(".ideal-field:first").find("input:first, select, textarea").focus():i.find(".ideal-field:first").find("input:first, select, textarea").focus(),i},i.focusFirstInvalid=function(){var e=i.getInvalid().first(),t=e.parents(".ideal-tabs-content").data("ideal-tabs-content-name");return f&&f.switchTab(t),e.find("input:first, select, textarea").focus(),i},i.switchTab=function(e){return f.switchTab(e),i},i.nextTab=function(){return f.nextTab(),i},i.prevTab=function(){return f.prevTab(),i},i.firstTab=function(){return f.firstTab(),i},i.lastTab=function(){return f.lastTab(),i},i.fresh=function(){return c().change().parents(".ideal-field").removeClass("valid invalid"),i},i.freshFields=function(e){e=t.convertToArray(e);for(var n=0,r=e.length;n<r;n++){var s=t.getByNameOrId(e[n]);s.blur().parents(".ideal-field").removeClass("valid invalid")}return i},i.reload=function(){return p.adjust(),p.attachEvents(),p.responsive(),i},i.reset=function(){var e=l();return e.text.val(""),e.radiocheck.removeAttr("checked"),e.select.find("option").first().prop("selected",!0),i.find(".ideal-select").trigger("reset"),e.inputs.change().blur(),i.focusFirst(),f&&f.firstTab(),i.fresh(),i},i.resetFields=function(e){e=t.convertToArray(e);var n=l(),r,s,o,u=e.length;for(o=0;o<u;o++)r=t.getByNameOrId(e[o]),s=t.getIdealType(r),(s==="text"||s==="file")&&r.val(""),s==="radiocheck"&&r.removeAttr("checked"),s==="select"&&(r.find("option").first().prop("selected",!0),r.next(".ideal-select").trigger("reset")),r.change().blur();return i.freshFields(e),i},i.setOptions=function(t){var n=o.options;return e.extend(!0,n,t),i.reload(),i.fresh(),i},i.setFieldOptions=function(t,n){var r=o.options.inputs[t];return e.extend(!0,r,n),i.reload(),i.freshFields([t]),i},i.toggleFields=function(n){n=t.convertToArray(n);var r=t.getFieldsFromArray(n);return r.each(function(){var t=e(this),n=t.attr("name")||t.attr("id"),r=o.options.inputs[n],s=r&&r.filters,u=t.data("ideal-filters")||"";t.data("ideal-filters",s),t.parents(".ideal-wrap").toggle(0,function(){i.setFieldOptions(n,{filters:u})})}),i},i.on({keydown:function(e){e.which===13&&e.target.nodeName!=="TEXTAREA"&&e.preventDefault()},submit:function(e){i.isValid()?a.onSuccess(e):(e.preventDefault(),a.onFail(),i.focusFirstInvalid())}}),f&&f.show(),p.init(),p.attachEvents(),i.fresh(),a.responsiveAt&&(e(window).resize(p.responsive),p.responsive()),f&&i.firstTab(),this}})(jQuery);