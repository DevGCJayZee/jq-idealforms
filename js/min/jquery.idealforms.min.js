/*--------------------------------------------------------------------------

  jq-idealforms 2.1

  * Author: Cedric Ruiz
  * License: GPL or MIT
  * Demo: http://elclanrs.github.com/jq-idealforms/
  *

--------------------------------------------------------------------------*/(function(e){"use strict";e.idealforms={},e.idealforms.filters={},e.idealforms.errors={},e.idealforms.flags={},e.idealforms.ajaxRequests={};var t={getMaxWidth:function(t){var n=0;return t.each(function(){var t=e(this).outerWidth();t>n&&(n=t)}),n},getLessVar:function(t,n){var r=e('<p class="'+t+'"></p>').hide().appendTo("body").css(n);return e("."+t).remove(),/^\d+/.test(r)?parseInt(r,10):r},getKeys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},getObjSize:function(e){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t},isFunction:function(e){return typeof e=="function"},isRegex:function(e){return e instanceof RegExp},isString:function(e){return typeof e=="string"},getByNameOrId:function(t){var n=e('[name="'+t+'"]').length?e('[name="'+t+'"]'):e("#"+t);return n.length?n:e.error('The field "'+t+"\" doesn't exist.")},getFieldsFromArray:function(n){var r=[];for(var i=0,s=n.length;i<s;i++)r.push(t.getByNameOrId(n[i]).get(0));return e(r)},convertToArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"?e:[e]},getIdealType:function(e){var t=e.attr("type")||e[0].tagName.toLowerCase();return/(text|password|email|number|search|url|tel|textarea)/.test(t)&&"text"||/file/.test(t)&&"file"||/select/.test(t)&&"select"||/(radio|checkbox)/.test(t)&&"radiocheck"||/(button|submit|reset)/.test(t)&&"button"||/h\d/.test(t)&&"heading"||/hr/.test(t)&&"separator"||/hidden/.test(t)&&"hidden"},makeInput:function(e,t,n,r){function l(e){var t,n,r;return/:/.test(e)?(r=e.split(":"),t=r[0],n=r[1]):t=n=e,{item:t,value:n}}var i,s=[],o,u,a,f;/^(text|password|email|number|search|url|tel|file|hidden)$/.test(t)&&(i='<input type="'+t+'" '+'id="'+e+'" '+'name="'+e+'" '+(r&&'placeholder="'+r+'"')+"/>"),/textarea/.test(t)&&(i='<textarea id="'+e+'" name="'+e+'"></textarea>');if(/select/.test(t)){s=[];for(a=0,f=n.length;a<f;a++)o=l(n[a]).item,u=l(n[a]).value,s.push('<option value="'+u+'">'+o+"</option>");i='<select id="'+e+'" name="'+e+'">'+s.join("")+"</select>"}if(/(radio|checkbox)/.test(t)){s=[];for(a=0,f=n.length;a<f;a++)o=l(n[a]).item,u=l(n[a]).value,s.push('<label><input type="'+t+'" name="'+e+'" value="'+u+'" />'+o+"</label>");i=s.join("")}return i}};e.fn.idealTabs=function(n){var r=this,i=n,s=e('<ul class="ideal-tabs-wrap"/>'),o=function(){var t=[];return r.each(function(){var n=e(this).attr("name"),r='<li class="ideal-tabs-tab"><span>'+n+"</span>"+'<i class="ideal-tabs-tab-counter ideal-tabs-tab-counter-zero">0</i>'+"</li>";t.push(r)}),e(t.join(""))}(),u={getCurIdx:function(){return o.filter(".ideal-tabs-tab-active").index()},getTabIdxByName:function(t){var n=new RegExp(t,"i"),r=o.filter(function(){return n.test(e(this).text())});return r.index()}},a={switchTab:function(e){var n=t.isString(e)?u.getTabIdxByName(e):e;o.removeClass("ideal-tabs-tab-active"),o.eq(n).addClass("ideal-tabs-tab-active"),r.hide().eq(n).show()},nextTab:function(){var e=u.getCurIdx()+1;e>o.length-1?a.firstTab():a.switchTab(e)},prevTab:function(){a.switchTab(u.getCurIdx()-1)},firstTab:function(){a.switchTab(0)},lastTab:function(){a.switchTab(o.length-1)},updateCounter:function(e,t){var n=isNaN(e)?u.getTabIdxByName(name):e,r=o.eq(n).find(".ideal-tabs-tab-counter");r.removeClass("ideal-tabs-tab-counter-zero"),t||r.addClass("ideal-tabs-tab-counter-zero"),r.html(t)}};for(var f in a)r[f]=a[f];return o.first().addClass("ideal-tabs-tab-active").end().click(function(){var t=e(this).text();r.switchTab(t)}),s.append(o).appendTo(i),r.addClass("ideal-tabs-content"),r.each(function(){var t=e(this),n=e(this).attr("name");t.data("ideal-tabs-content-name",n).removeAttr("name")}),r.hide().first().show(),r},e.fn.idealSelect=function(){return this.each(function(){var n=e(this),r=n.find("option"),i=function(){var t=e('<ul class="ideal-select '+n.attr("name")+'"/>'),i=e('<li><span class="ideal-select-title">'+r.filter(":selected").text()+"</span></li>"),s=function(){var t=[];return r.each(function(){var n=e(this);t.push('<li class="ideal-select-item">'+n.text()+"</li>")}),t}();return i.append('<ul class="ideal-select-sub">'+s.join("")+"</ul>"),t.append(i),{select:t,title:i.find(".ideal-select-title"),sub:i.find(".ideal-select-sub"),items:i.find(".ideal-select-item")}}(),s={getSelectedIdx:function(){return i.items.filter(".ideal-select-item-selected").index()},init:function(){n.css({position:"absolute",left:"-9999px"}),i.sub.hide(),i.select.insertAfter(n),i.select.css("min-width",t.getMaxWidth(i.items)),i.items.eq(r.filter(":selected").index()).addClass("ideal-select-item-selected")}(),noWindowScroll:function(e){(e.which===40||e.which===38||e.which===13)&&e.preventDefault()},focusHack:function(){setTimeout(function(){n.trigger("focus")},1)},focus:function(){i.select.addClass("ideal-select-focus"),e(document).on("keydown.noscroll",s.noWindowScroll)},blur:function(){i.select.removeClass("ideal-select-open ideal-select-focus"),e(document).off(".noscroll")},scrollIntoView:function(e){var t=i.items.filter(".ideal-select-item-selected"),n=i.items.outerHeight(),r=i.sub.outerHeight(),s=function(){var i=t.position().top+n;return e==="down"?i<=r:i>0}();s||(n=e==="down"?n:-n,i.sub.scrollTop(i.sub.scrollTop()+n))},scrollToItem:function(){var e=s.getSelectedIdx(),t=i.items.outerHeight(),n=i.items.length,r=t*n,o=t*(n-e);i.sub.scrollTop(r-o)},showMenu:function(){i.sub.fadeIn("fast"),i.select.addClass("ideal-select-open"),s.select(s.getSelectedIdx()),s.scrollToItem()},hideMenu:function(){i.sub.hide(),i.select.removeClass("ideal-select-open")},select:function(e){i.items.removeClass("ideal-select-item-selected"),i.items.eq(e).addClass("ideal-select-item-selected")},change:function(e){var t=i.items.eq(e).text();s.select(e),i.title.text(t),r.eq(e).prop("selected",!0),n.trigger("change")},keydown:function(t){var n=s.getSelectedIdx(),o=i.select.is(".ideal-select-menu"),u=i.select.is(".ideal-select-open"),a={9:function(){o&&(s.blur(),s.hideMenu())},13:function(){o&&(u?s.hideMenu():s.showMenu()),s.change(n)},27:function(){o&&s.hideMenu()},40:function(){n<r.length-1&&(u?s.select(n+1):s.change(n+1)),s.scrollIntoView("down")},38:function(){n>0&&(u?s.select(n-1):s.change(n-1)),s.scrollIntoView("up")},"default":function(){var n=String.fromCharCode(t),r=i.items.filter(function(){var t=new RegExp("^"+n,"i");return t.test(e(this).text())}),o=r.length,a=i.select.data("counter")+1||0,f=i.select.data("key")||t,l=r.eq(a).index();if(!o)return!1;f===t?a<o?i.select.data("counter",a):(i.select.data("counter",0),l=r.eq(0).index()):(i.select.data("counter",0),l=r.eq(0).index()),u?s.select(l):s.change(l),i.select.data("key",t),s.scrollToItem(),s.focusHack()}};a[t]?a[t]():a["default"]()}},o={focus:s.focus,"blur.menu":function(){s.blur(),s.hideMenu()},"blur.list":function(){s.blur()},keydown:function(e){s.keydown(e.which)},"clickItem.menu":function(){s.change(e(this).index()),s.hideMenu()},"clickItem.list":function(){s.change(e(this).index())},"clickTitle.menu":function(){s.focus(),s.showMenu(),n.trigger("focus")},"hideOutside.menu":function(){n.off("blur.menu"),e(document).on("mousedown.ideal",function(t){e(t.target).closest(i.select).length?s.focusHack():(e(document).off("mousedown.ideal"),n.on("blur.menu",o["blur.menu"]))})},"mousedown.list":function(){s.focusHack()}},u=function(){i.select.removeClass("ideal-select-menu ideal-select-list"),n.off(".menu .list"),i.items.off(".menu .list"),i.select.off(".menu .list"),i.title.off(".menu .list")};i.select.on("menu",function(){u(),i.select.addClass("ideal-select-menu"),s.hideMenu(),n.on({"blur.menu":o["blur.menu"],"focus.menu":o.focus,"keydown.menu":o.keydown}),i.select.on("mousedown.menu",o["hideOutside.menu"]),i.items.on("click.menu",o["clickItem.menu"]),i.title.on("click.menu",o["clickTitle.menu"])}),i.select.on("list",function(){u(),i.select.addClass("ideal-select-list"),s.showMenu(),n.on({"blur.list":o["blur.list"],"focus.list":o.focus,"keydown.list":o.keydown}),i.select.on("mousedown.list",o["mousedown.list"]),i.items.on("mousedown.list",o["clickItem.list"])}),n.keydown(function(e){e.which!==9&&e.preventDefault()}),i.select.on("reset",function(){s.change(0)}),i.select.trigger("menu")})},function(){e.fn.idealRadioCheck=function(){return this.each(function(){var t=e(this),n=e("<span/>");n.addClass("ideal-"+(t.is(":checkbox")?"check":"radio")),t.is(":checked")&&n.addClass("checked"),n.insertAfter(t),t.parent("label").addClass("ideal-radiocheck-label").attr("onclick",""),t.css({position:"absolute",left:"-9999px"}),t.on({change:function(){var t=e(this);t.is(":radio")&&t.parent().siblings("label").find(".ideal-radio").removeClass("checked"),n.toggleClass("checked",e(this).is(":checked"))},focus:function(){n.addClass("focus")},blur:function(){n.removeClass("focus")},click:function(){e(this).trigger("focus")}})})}}(),e.fn.idealFile=function(){var t=typeof e("input")[0].multiple!="undefined";return this.each(function(){var n=e(this),r=e('<div class="ideal-file-wrap">'),i=e('<input type="text" class="ideal-file-filename" />'),s=e('<button type="button" class="ideal-file-upload">Open</button>');n.css({position:"absolute",left:"-9999px"}),s.attr("tabIndex",-1).click(function(){n.focus().click()}),n.attr("tabIndex",-1).on({change:function(){var e=[],r,s;if(t){r=n[0].files;for(var o=0,u=r.length;o<u;o++)e.push(r[o].name);s=e.join(", ")}else s=n.val().split("\\").pop();i.val(s),i.attr("title",s)}}),i.on({keyup:function(){n.trigger("change")},focus:function(){n.trigger("change")},blur:function(){n.trigger("blur")},keydown:function(e){e.which===13&&n.trigger("click"),(e.which===8||e.which===46)&&n.val("")}}),r.append(s,i).insertAfter(n)})},e.idealforms.errors={required:"This field is required.",number:"Must be a number.",digits:"Must be only digits.",name:"Must be at least 3 characters long, and must only contain letters.",username:"Must be at between 4 and 32 characters long and start with a letter. You may use letters, numbers, underscores, and one dot (.)",pass:"Must be at least 6 characters long, and contain at least one number, one uppercase and one lowercase letter.",strongpass:"Must be at least 8 characters long and contain at least one uppercase and one lowercase letter and one number or special character.",email:"Must be a valid e-mail address. <em>(e.g. user@gmail.com)</em>",phone:"Must be a valid US phone number. <em>(e.g. 555-123-4567)</em>",zip:"Must be a valid US zip code. <em>(e.g. 33245 or 33245-0003)</em>",url:"Must be a valid URL. <em>(e.g. www.google.com)</em>",minChar:"Must be at least <strong>{0}</strong> characters long.",minOption:"Check at least <strong>{0}</strong> options.",maxChar:"No more than <strong>{0}</strong> characters long.",maxOption:"No more than <strong>{0}</strong> options allowed.",range:"Must be a number between {0} and {1}.",date:"Must be a valid date. <em>(e.g. {0})</em>",dob:"Must be a valid date of birth.",exclude:'"{0}" is not available.',excludeOption:"{0}",equalto:'Must be the same value as <strong>"{0}"</strong>',extension:'File(s) must have a valid extension. <em>(e.g. "{0}")</em>',ajaxSuccess:"<strong>{0}</strong> is not available.",ajaxError:"Server error..."};var n=function(){var t={required:{regex:/.+/,error:e.idealforms.errors.required},number:{regex:function(e,t){return!isNaN(t)},error:e.idealforms.errors.number},digits:{regex:/^\d+$/,error:e.idealforms.errors.digits},name:{regex:/^[A-Za-z]{3,}$/,error:e.idealforms.errors.name},username:{regex:/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i,error:e.idealforms.errors.username},pass:{regex:/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/,error:e.idealforms.errors.pass},strongpass:{regex:/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/,error:e.idealforms.errors.strongpass},email:{regex:/[^@]+@[^@]/,error:e.idealforms.errors.email},phone:{regex:/^[2-9]\d{2}-\d{3}-\d{4}$/,error:e.idealforms.errors.phone},zip:{regex:/^\d{5}$|^\d{5}-\d{4}$/,error:e.idealforms.errors.zip},url:{regex:/^(?:(ftp|http|https):\/\/)?(?:[\w\-]+\.)+[a-z]{2,6}([\:\/?#].*)?$/i,error:e.idealforms.errors.url},min:{regex:function(t,n){var r=t.input,i=t.userOptions.data.min,s=r.is('[type="checkbox"], [type="radio"]');return s?(this.error=e.idealforms.errors.minOption.replace("{0}",i),r.filter(":checked").length>=i):(this.error=e.idealforms.errors.minChar.replace("{0}",i),n.length>=i)}},max:{regex:function(t,n){var r=t.input,i=t.userOptions.data.max,s=r.is('[type="checkbox"], [type="radio"]');return s?(this.error=e.idealforms.errors.maxOption.replace("{0}",i),r.filter(":checked").length<=i):(this.error=e.idealforms.errors.maxChar.replace("{0}",i),n.length<=i)}},range:{regex:function(t,n){var r=t.userOptions.data.range,i=+n;return this.error=e.idealforms.errors.range.replace("{0}",r[0]).replace("{1}",r[1]),i>=r[0]&&i<=r[1]}},date:{regex:function(t,n){var r=t.userOptions.data&&t.userOptions.data.date?t.userOptions.data.date:"mm/dd/yyyy",i=/[^mdy]/.exec(r)[0],s=r.split(i),o=n.split(i),u=function(e,t){var n,r,i;for(var s=0,o=t.length;s<o;s++)/m/.test(t[s])&&(n=e[s]),/d/.test(t[s])&&(r=e[s]),/y/.test(t[s])&&(i=e[s]);return n>0&&n<13&&i&&i.length===4&&r>0&&r<=(new Date(i,n,0)).getDate()};return this.error=e.idealforms.errors.date.replace("{0}",r),u(o,s)}},dob:{regex:function(n,r){var i=n.userOptions.data&&n.userOptions.data.dob?n.userOptions.data.dob:"mm/dd/yyyy",s={input:n.input,userOptions:{data:{date:i}}},o=t.date.regex(s,r),u=/\d{4}/.exec(r),a=(new Date).getFullYear(),f=a-100;return this.error=e.idealforms.errors.dob,o&&u>=f&&u<=a}},exclude:{regex:function(t,n){var r=t.input,i=t.userOptions.data.exclude,s=r.is('[type="checkbox"], [type="radio"], select');return this.error=s?e.idealforms.errors.excludeOption.replace("{0}",n):this.error=e.idealforms.errors.exclude.replace("{0}",n),e.inArray(n,i)===-1}},equalto:{regex:function(t,n){var r=e(t.userOptions.data.equalto),i=t.input,s=r.attr("name")||r.attr("id"),o=r.parents(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!0}).length;return o?(this.error=e.idealforms.errors.equalto.replace("{0}",s),i.val()===r.val()):!1}},extension:{regex:function(t,n){var r=t.input[0].files||[{name:n}],i=t.userOptions.data.extension,s=new RegExp("\\."+i.join("|")+"$","i"),o=!1;for(var u=0,a=r.length;u<a;u++)o=s.test(r[u].name);return this.error=e.idealforms.errors.extension.replace("{0}",i.join('", "')),o}},ajax:{regex:function(t,n,r){var i=this,s=t.input,o=t.userOptions,u=s.attr("name"),a=s.parents(".ideal-field"),f=!1,l=o.errors&&o.errors.ajax;i.error={},i.error.success=l&&l.success?l.success:e.idealforms.errors.ajaxSuccess.replace("{0}",n),i.error.fail=l&&l.error?l.error:e.idealforms.errors.ajaxError;var c={};c[u]=e.trim(n);var h=e.extend({type:"post",dataType:"json",data:c,success:function(e){r(i.error.success,e),s.data({"ideal-ajax-error":i.error.success,"ideal-ajax-resp":e}),s.trigger("change"),a.removeClass("ajax")},error:function(){r(i.error.fail,!1),s.data("ideal-ajax-error",i.error.fail),a.removeClass("ajax")}},t.userOptions.data.ajax);s.removeData("ideal-ajax-resp"),a.addClass("ajax"),e.idealforms.ajaxRequests[u]=e.ajax(h)}}};return t},r={inputs:{},customFilters:{},customFlags:{},globalFlags:"",onSuccess:function(e){alert("Thank you...")},onFail:function(){alert("Invalid!")},responsiveAt:"auto",disableCustom:""},i=function(t,i){var s=this;s.$form=e(t),s.opts=e.extend({},r,i),s.$tabs=s.$form.find("section"),e.extend(e.idealforms.filters,n()),s._init()};e.fn.idealforms=function(t){return this.each(function(){e.data(this,"idealforms")||e.data(this,"idealforms",new i(this,t))})};var s={fieldWidth:t.getLessVar("ideal-field-width","width")};e.extend(i.prototype,{_init:function(){var t=this,n=t.opts,r=t._getFormElements();t.$form.css("visibility","visible").addClass("ideal-form").attr("novalidate","novalidate"),r.inputs.add(r.headings).add(r.separators).each(function(){t._doMarkup(e(this))});if(t.$tabs.length){var i=e('<div class="ideal-wrap ideal-tabs ideal-full-width"/>');t.$form.prepend(i),t.$tabs.idealTabs(i)}jQuery.ui&&(e.datepicker._checkOffset=function(e,t,n){return t}),t.$form.find("[data-ideal]").each(function(){n.inputs[this.name]={filters:e(this).data("ideal")}}),n.responsiveAt&&(e(window).resize(function(){t._responsive()}),t._responsive()),t.$form.on({keydown:function(e){e.which===13&&e.target.nodeName!=="TEXTAREA"&&e.preventDefault()},submit:function(e){t.isValid()?n.onSuccess(e):(e.preventDefault(),n.onFail(),t.focusFirstInvalid())}}),t._adjust(),t._attachEvents(),t.fresh()},_getFormElements:function(){return{inputs:this.$form.find("input, select, textarea, :button"),labels:this.$form.find("div > label:first-child"),text:this.$form.find('input:not([type="checkbox"], [type="radio"], [type="submit"]), textarea'),select:this.$form.find("select"),radiocheck:this.$form.find('input[type="radio"], input[type="checkbox"]'),buttons:this.$form.find(":button"),file:this.$form.find('input[type="file"]'),headings:this.$form.find("h1, h2, h3, h4, h5, h6"),separators:this.$form.find("hr"),hidden:this.$form.find("input:hidden")}},_getUserInputs:function(){return this.$form.find('[name="'+t.getKeys(this.opts.inputs).join('"], [name="')+'"]')},_getTab:function(t){var n=this,r=!isNaN(t);return r?n.$tabs.eq(t):n.$tabs.filter(function(){var n=new RegExp(t,"i");return n.test(e(this).data("ideal-tabs-content-name"))})},_getCurrentTabIdx:function(){return this.$form.find(".ideal-tabs-content:visible").index()},_updateTabsCounter:function(){var e=this;e.$tabs.each(function(t){var n=e.getInvalidInTab(t).length;e.$tabs.updateCounter(t,n)})},_adjust:function(){var n=this,r=n.opts,i=this._getFormElements();i.inputs.attr("autocomplete","off"),n.$tabs.length&&n.$tabs.show();var s=i.labels;s.removeAttr("style").width(t.getMaxWidth(s)),n.$tabs.length?this.$tabs.each(function(){e(this).find(".ideal-heading:first").addClass("first-child")}):n.$form.find(".ideal-heading:first").addClass("first-child"),n._setDatepicker(),n.$tabs.length&&n.$tabs.hide().first().show()},_setDatepicker:function(){var t=this.opts,n=this.$form.find("input.datepicker");jQuery.ui&&n.length&&(n.each(function(){var n=t.inputs[this.name],r=n&&n.data&&n.data.date,i=r?r.replace("yyyy","yy"):"mm/dd/yy";e(this).datepicker({dateFormat:i,beforeShow:function(t){e(t).addClass("open")},onChangeMonthYear:function(){var t=e(this),n=t.outerWidth();setTimeout(function(){t.datepicker("widget").css("width",n)},1)},onClose:function(){e(this).removeClass("open")}})}),n.on("focus keyup",function(){var t=e(this),n=t.outerWidth();t.datepicker("widget").css("width",n)}),n.parent().siblings(".ideal-error").addClass("hidden"))},_doMarkup:function(n){var r=this.opts,i=t.getIdealType(n),s=e('<span class="ideal-field"/>'),o=e('<span class="ideal-error" />'),u=e('<i class="ideal-icon ideal-icon-valid" />'),a=e('<i class="ideal-icon ideal-icon-invalid"/>').click(function(){alert("hey")});n.closest("div").addClass("ideal-wrap").children("label:first-child").addClass("ideal-label");var f={_defaultInput:function(){n.wrapAll(s).after(u,a).parent().after(o)},text:function(){f._defaultInput()},radiocheck:function(){var e=n.parents(".ideal-field").length;e||(n.parent().nextAll().andSelf().wrapAll(s.addClass("ideal-radiocheck")),n.parents(".ideal-field").append(u,a).after(o)),/radiocheck/.test(r.disableCustom)||n.idealRadioCheck()},select:function(){f._defaultInput(),/select/.test(r.disableCustom)||n.idealSelect()},file:function(){f._defaultInput(),/file/.test(r.disableCustom)||n.idealFile()},button:function(){/button/.test(r.disableCustom)||n.addClass("ideal-button")},hidden:function(){n.closest("div").addClass("ideal-hidden")},heading:function(){n.closest("div").addClass("ideal-full-width"),n.parent().children().wrapAll('<span class="ideal-heading"/>')},separator:function(){n.closest("div").addClass("ideal-full-width"),n.wrapAll('<div class="ideal-separator"/>')}};f[i]?f[i]():e.noop(),o.add(u).add(a).hide()},_validate:function(n,r){function v(){c.removeClass("valid invalid").removeData("ideal-isvalid"),h.add(p).add(d).hide()}function m(e,t){v(),t?d.show():p.show(),c.addClass(t?"valid":"invalid"),c.data("ideal-isvalid",t),t||h.html(e).toggle(c.is(".ideal-field-focus"))}var i=this,s=this.opts,o=s.inputs[n.attr("name")],u=o.filters&&o.filters.split(/\s/),a=n.attr("name"),f=n.val(),l=n.is('[type="checkbox"], [type="radio"]'),c=n.parents(".ideal-field"),h=c.siblings(".ideal-error"),p=l?n.parent().siblings(".ideal-icon-invalid"):n.siblings(".ideal-icon-invalid"),d=l?n.parent().siblings(".ideal-icon-valid"):n.siblings(".ideal-icon-valid"),g=n.data("ideal-value")||0;n.data("ideal-value",f);if(r.type==="keyup"&&f===g)return!1;u?e.each(u,function(s,u){var c=e.idealforms.filters[u],p=o.errors&&o.errors[u],d="",g={input:l?i.$form.find('[name="'+a+'"]'):n,userOptions:o};if(!f&&u!=="required")return v(),!1;if(c)if(u==="ajax"){var y=e.idealforms.ajaxRequests[a];m(d,!1),r.type==="keyup"?(y&&y.abort(),c.regex(g,f,m),h.hide()):m(n.data("ideal-ajax-error"),n.data("ideal-ajax-resp")||!1)}else{var b=t.isRegex(c.regex)&&c.regex.test(f)||t.isFunction(c.regex)&&c.regex(g,f);d=p||c.error,m(d,b);if(!b)return!1}}):v();var y=function(){var t=o.flags&&o.flags.split(" ")||[];return s.globalFlags&&e.each(s.globalFlags.split(),function(e,n){t.push(n)}),t}();y.length&&e.each(y,function(t,i){var s=e.idealforms.flags[i];s&&s(n,r.type)}),i.$tabs.length&&i._updateTabsCounter(i._getCurrentTabIdx())},_attachEvents:function(){var t=this;t._getUserInputs().on("keyup change focus blur",function(n){var r=e(this),i=r.parents(".ideal-field"),s=r.is("input[type=file]");(n.type==="focus"||s&&n.type==="change")&&i.addClass("ideal-field-focus"),n.type==="blur"&&i.removeClass("ideal-field-focus"),t._validate(r,n)})},_responsive:function(){var t=this._getFormElements(),n=s.fieldWidth+t.labels.outerWidth(),r=t.labels.filter(function(){return e(this).html()==="&nbsp;"}),i=this.$form.find(".ideal-select");this.opts.responsiveAt==="auto"?this.$form.toggleClass("stack",this.$form.width()<n):this.$form.toggleClass("stack",e(window).width()<this.opts.responsiveAt);var o=this.$form.is(".stack");r.toggle(!o),i.trigger(o?"list":"menu");var u=this.$form.find("input.hasDatepicker");u.length&&u.datepicker("hide")}}),e.extend(i.prototype,{getInvalid:function(){return this.$form.find(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!1})},getInvalidInTab:function(t){return this._getTab(t).find(".ideal-field").filter(function(){return e(this).data("ideal-isvalid")===!1})},isValid:function(){return!this.getInvalid().length},isValidField:function(e){var n=t.getByNameOrId(e);return n.parents(".ideal-field").data("ideal-isvalid")===!0},focusFirst:function(){return this.$tabs.length?this.$tabs.filter(":visible").find(".ideal-field:first").find("input:first, select, textarea").focus():this.$form.find(".ideal-field:first").find("input:first, select, textarea").focus(),this},focusFirstInvalid:function(){var e=this.getInvalid().first().find("input:first, select, textarea"),t=e.parents(".ideal-tabs-content").data("ideal-tabs-content-name");return this.$tabs.length&&this.switchTab(t),e.focus(),this},switchTab:function(e){return this.$tabs.switchTab(e),this},nextTab:function(){return this.$tabs.nextTab(),this},prevTab:function(){return this.$tabs.prevTab(),this},firstTab:function(){return this.$tabs.firstTab(),this},lastTab:function(){return this.$tabs.lastTab(),this},fresh:function(){return this._getUserInputs().change().parents(".ideal-field").removeClass("valid invalid"),this},freshFields:function(n){return n=t.convertToArray(n),e.each(n,function(e){var r=t.getByNameOrId(n[e]);r.change().parents(".ideal-field").removeClass("valid invalid")}),this},reload:function(){return this._adjust(),this._attachEvents(),this._getUserInputs().change(),this},reset:function(){var e=this._getFormElements();return e.text.val(""),e.radiocheck.removeAttr("checked"),e.select.find("option").first().prop("selected",!0),this.$form.find(".ideal-select").trigger("reset"),this.$tabs.length&&this.firstTab(),this.focusFirst().fresh(),this},resetFields:function(n){n=t.convertToArray(n);var r=this._getFormElements();return e.each(n,function(e,n){var r=t.getByNameOrId(n),i=t.getIdealType(r);(i==="text"||i==="file")&&r.val(""),i==="radiocheck"&&r.removeAttr("checked"),i==="select"&&(r.find("option").first().prop("selected",!0),r.next(".ideal-select").trigger("reset")),r.change()}),this.freshFields(n),this},toggleFields:function(n){n=t.convertToArray(n);var r=this,i=t.getFieldsFromArray(n);return i.each(function(){var t=e(this),n=t.attr("name")||t.attr("id"),i=r.opts.inputs[n],s=i&&i.filters,o=t.data("ideal-filters")||"";t.data("ideal-filters",s),t.closest(".ideal-wrap").toggle(),r.setFieldOptions(n,{filters:o})}),r._getUserInputs().change(),this},setOptions:function(t){return e.extend(!0,this.opts,t),this.reload().fresh(),this},setFieldOptions:function(t,n){return e.extend(!0,this.opts.inputs[t],n),this.reload().freshFields([t]),this},addFields:function(n){function s(n){var s=n.name,o={filters:n.filters||"",data:n.data||{},errors:n.errors||{},flags:n.flags||""},u=n.label||"",a=n.type,f=n.list||[],l=n.placeholder||"",c=e("<div><label>"+u+":</label>"+t.makeInput(s,a,f,l)+"</div>"),h=c.find("input, select, textarea, :button");o.filters&&(r.opts.inputs[s]=o),r._doMarkup(h),n.addAfter?c.insertAfter(e(t.getByNameOrId(n.addAfter)).parents(".ideal-wrap")):n.addBefore?c.insertBefore(e(t.getByNameOrId(n.addBefore)).parents(".ideal-wrap")):n.appendToTab?c.insertAfter(r._getTab(n.appendToTab).find(".ideal-wrap:last-child")):c.insertAfter($form.find(".ideal-wrap").last()),i.push(s)}n=t.convertToArray(n);var r=this,i=[];return e.each(n,function(e,t){s(t)}),r.reload(),r.freshFields(i),r._responsive(),this},removeFields:function(e){e=t.convertToArray(e);var n=t.getFieldsFromArray(e);return n.parents(".ideal-wrap").remove(),this.reload(),this}})})(jQuery);